import{z as C,D as $,c as h,n as I,b as l,W as S,C as P,V as F}from"./vendor.4be520cf.js";import{S as w,c as f,e as u,B as p}from"./index.3277bc57.js";import{F as D,A,D as z,T as M}from"./GestureTap.1e432692.js";var R=C({name:"TradeActions",components:{DeleteIcon:$,ForceSellIcon:D},props:{botApiVersion:{type:Number,default:1},trade:{type:Object,required:!0}},emits:["forceSell","deleteTrade"],setup(){return{}}}),v=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"d-flex flex-column"},[e.botApiVersion<=1.1?t("b-button",{staticClass:"btn-xs text-left",attrs:{size:"sm",title:"Forcesell"},on:{click:function(r){return e.$emit("forceSell",e.trade)}}},[t("ForceSellIcon",{staticClass:"mr-1",attrs:{size:16,title:"Forcesell"}}),e._v("Forcesell ")],1):e._e(),e.botApiVersion>1.1?t("b-button",{staticClass:"btn-xs text-left",attrs:{size:"sm",title:"Forcesell limit"},on:{click:function(r){return e.$emit("forceSell",e.trade,"limit")}}},[t("ForceSellIcon",{staticClass:"mr-1",attrs:{size:16,title:"Forcesell"}}),e._v("Forcesell limit ")],1):e._e(),e.botApiVersion>1.1?t("b-button",{staticClass:"btn-xs text-left mt-1",attrs:{size:"sm",title:"Forcesell market"},on:{click:function(r){return e.$emit("forceSell",e.trade,"market")}}},[t("ForceSellIcon",{staticClass:"mr-1",attrs:{size:16,title:"Forcesell"}}),e._v("Forcesell market ")],1):e._e(),t("b-button",{staticClass:"btn-xs text-left mt-1",attrs:{size:"sm",title:"Delete trade"},on:{click:function(r){return e.$emit("deleteTrade",e.trade)}}},[t("DeleteIcon",{staticClass:"mr-1",attrs:{size:16,title:"Delete trade"}}),e._v(" Delete ")],1)],1)},V=[];v._withStripped=!0;const m={};var b=h(R,v,V,!1,B,"90c1dc82",null,null);function B(e){for(let s in m)this[s]=m[s]}b.options.__file="src/components/ftbot/TradeActions.vue";var O=function(){return b.exports}(),j=Object.defineProperty,L=Object.getOwnPropertyDescriptor,o=(e,s,t,r)=>{for(var i=r>1?void 0:r?L(s,t):s,c=e.length-1,d;c>=0;c--)(d=e[c])&&(i=(r?d(s,t,i):d(i))||i);return r&&i&&j(s,t,i),i},y,T,x;const n=I(w.ftbot);let a=class extends F{constructor(){super(...arguments);this.formatPercent=f,this.formatPrice=u,this.currentPage=1,this.selectedItemIndex=void 0,this.filterText="",this.perPage=this.activeTrades?200:15,this.openFields=[{key:"actions"}],this.closedFields=[{key:"close_timestamp",label:"Close date"},{key:"sell_reason",label:"Close Reason"}],this.tableFields=[this.multiBotView?{key:"botName",label:"Bot"}:{},{key:"trade_id",label:"ID"},{key:"pair",label:"Pair"},{key:"amount",label:"Amount"},{key:"stake_amount",label:"Stake amount",formatter:e=>this.formatPriceWithDecimals(e)},{key:"open_rate",label:"Open rate",formatter:e=>this.formatPrice(e)},{key:this.activeTrades?"current_rate":"close_rate",label:this.activeTrades?"Current rate":"Close rate",formatter:e=>this.formatPrice(e)},{key:"profit",label:this.activeTrades?"Current profit %":"Profit %",formatter:(e,s,t)=>`${f(t.profit_ratio,2)} ${`(${this.formatPriceWithDecimals(t.profit_abs)})`}`},{key:"open_timestamp",label:"Open date"},...this.activeTrades?this.openFields:this.closedFields]}watchTradeDetail(e){this.trades.findIndex(t=>t.trade_id===e)<0&&this.$refs.tradesTable.clearSelected()}get rows(){return this.trades.length}formatPriceWithDecimals(e){return u(e,this.stakeCurrencyDecimals)}forcesellHandler(e,s=void 0){this.$bvModal.msgBoxConfirm(`Really forcesell trade ${e.trade_id} (Pair ${e.pair})?`).then(t=>{if(t){const r={tradeid:String(e.trade_id),botId:e.botId};s&&(r.ordertype=s),this.forceSellMulti(r).then(i=>console.log(i)).catch(i=>console.log(i.response))}})}handleContextMenuEvent(e,s,t){!this.activeTrades||(t.preventDefault(),console.log(e))}removeTradeHandler(e){console.log(e),this.$bvModal.msgBoxConfirm(`Really delete trade ${e.trade_id} (Pair ${e.pair})?`).then(s=>{if(s){const t={tradeid:String(e.trade_id),botId:e.botId};this.deleteTradeMulti(t).catch(r=>console.log(r.response))}})}onRowClicked(e,s){e&&e.trade_id!==this.detailTradeId&&!this.$refs.tradesTable.isRowSelected(s)?this.setDetailTrade(e):(console.log("unsetting item"),this.setDetailTrade(null))}onRowSelected(){if(this.detailTradeId){const e=this.trades.findIndex(s=>s.trade_id===this.detailTradeId);e>=0?this.$refs.tradesTable.selectRow(e):(console.log(`Unsetting item for tradeid ${this.selectedItemIndex}`),this.selectedItemIndex=void 0)}}};y=p.detailTradeId,T=p.stakeCurrencyDecimals,x=p.botApiVersion;o([l({required:!0})],a.prototype,"trades",2);o([l({default:"Trades"})],a.prototype,"title",2);o([l({required:!1,default:""})],a.prototype,"stakeCurrency",2);o([l({default:!1})],a.prototype,"activeTrades",2);o([l({default:!1})],a.prototype,"showFilter",2);o([l({default:!1,type:Boolean})],a.prototype,"multiBotView",2);o([l({default:"No Trades to show."})],a.prototype,"emptyText",2);o([n.Getter],a.prototype,y,2);o([n.Getter],a.prototype,T,2);o([n.Getter],a.prototype,x,2);o([n.Action],a.prototype,"setDetailTrade",2);o([n.Action],a.prototype,"forceSellMulti",2);o([n.Action],a.prototype,"deleteTradeMulti",2);o([S("detailTradeId")],a.prototype,"watchTradeDetail",1);a=o([P({components:{ActionIcon:A,DateTimeTZ:z,TradeProfit:M,TradeActions:O}})],a);var g=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"h-100 overflow-auto w-100"},[t("b-table",{ref:"tradesTable",attrs:{small:"",hover:"",stacked:"md",items:e.trades,fields:e.tableFields,"show-empty":"","empty-text":e.emptyText,"per-page":e.perPage,"current-page":e.currentPage,"primary-key":"botTradeId",selectable:"","select-mode":"single",filter:e.filterText},on:{"row-contextmenu":e.handleContextMenuEvent,"row-clicked":e.onRowClicked,"row-selected":e.onRowSelected},scopedSlots:e._u([{key:"cell(actions)",fn:function(r){return[t("b-button",{staticClass:"btn-xs",attrs:{id:"btn-actions_"+r.index,size:"sm",title:"Actions"}},[t("ActionIcon",{attrs:{size:16,title:"Actions"}})],1),t("b-popover",{attrs:{target:"btn-actions_"+r.index,triggers:"focus",placement:"left"}},[t("trade-actions",{attrs:{trade:r.item,"bot-api-version":e.botApiVersion},on:{deleteTrade:e.removeTradeHandler,forceSell:e.forcesellHandler}})],1)]}},{key:"cell(pair)",fn:function(r){return[t("span",[e._v(" "+e._s(""+r.item.pair+(r.item.open_order_id===void 0||r.item.open_order_id===null?"":"*"))+" ")])]}},{key:"cell(trade_id)",fn:function(r){return[e._v(" "+e._s(r.item.trade_id)+" "+e._s(e.botApiVersion>2?"| "+(r.item.is_short?"Short":"Long"):"")+" ")]}},{key:"cell(profit)",fn:function(r){return[t("trade-profit",{attrs:{trade:r.item}})]}},{key:"cell(open_timestamp)",fn:function(r){return[t("DateTimeTZ",{attrs:{date:r.item.open_timestamp}})]}},{key:"cell(close_timestamp)",fn:function(r){return[t("DateTimeTZ",{attrs:{date:r.item.close_timestamp}})]}}])}),t("div",{staticClass:"w-100 d-flex justify-content-between"},[e.activeTrades?e._e():t("b-pagination",{attrs:{"total-rows":e.rows,"per-page":e.perPage,"aria-controls":"my-table"},model:{value:e.currentPage,callback:function(r){e.currentPage=r},expression:"currentPage"}}),e.showFilter?t("b-input",{staticStyle:{width:"unset"},attrs:{type:"text",placeholder:"Filter",size:"sm"},model:{value:e.filterText,callback:function(r){e.filterText=r},expression:"filterText"}}):e._e()],1)],1)},W=[];g._withStripped=!0;const _={};var k=h(a,g,W,!1,E,"2e1f5068",null,null);function E(e){for(let s in _)this[s]=_[s]}k.options.__file="src/components/ftbot/TradeList.vue";var N=function(){return k.exports}();export{N as T};
//# sourceMappingURL=TradeList.7dbd6e10.js.map
